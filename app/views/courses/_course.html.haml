.card
  .card-header
    .fa.fa-graduation-cap
    = link_to course.name, course
  .card-body
    %small= simple_format(course.short_description)
  .card-footer
    .row
      .col-md-6
        .text-warning.fa.fa-star
        %b= course.average_rating
        (#{course.subscriptions_count}
        .fa.fa-user-graduate
        )
  
      .col-md-6.text-right
        .fa.fa-chalkboard-teacher
        = course.user
  /.card-footer
  /  %h6
  /    - if course.bought(current_user) == false
  /      Bought
  /    - else
  /      Buy

  .card-footer
    .text-center
      /= subscription_buttons(course)
      /.row
      /= review_buttons(course)
      /%hr.bg-danger
      - if current_user
        - if course.user == current_user
          .row
          /OWNER
          = link_to course_path(course) do
            You've created this course. View analytics
        - elsif course.subscriptions.where(user: current_user).any?
          .row
          /SUBSCRIBER
          = link_to course_path(course) do
            You've bought this course. Now, learn
          - if course.subscriptions.pending_review.where(user: current_user).any?
            .row
            /SUBSCRIBER did not review
            = link_to edit_subscription_path(course.subscriptions.pending_review.where(user: current_user).first) do
              .text-warning.fa.fa-star
              Review
          - else
            .row
            /SUBSCRIBER reviewed
            .text-warning.fa.fa-star
            .fa.fa-check
        - else
          .row
          /BUYER
          = link_to course_path(course), class: 'btn btn-md btn-success' do
            .fa.fa-shopping-cart
            = number_to_currency(course.price)
          /= link_to 'Subscribe', Subscription.create(course: course, user:current_user)
      - else
        .row
        /TEASER
        = link_to course_path(course), class: 'btn btn-md btn-success' do
          .fa.fa-shopping-cart
          Check price
  - if current_user
    - if course.user_id == current_user.id
      .card-footer
        - if course.published?
          .badge.badge-success
            published
        - else
          .badge.badge-danger
            published
        - if course.approved?
          .badge.badge-success
            approved
        - else
          .badge.badge-danger
            approved
      .card-footer
        = link_to 'Edit', edit_course_path(course), class: 'btn btn-sm btn-primary'
        = link_to 'Destroy', course, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-primary'
        - if course.approved?
          = link_to 'Disapprove', disapprove_course_path(course), method: :patch, class: 'btn btn-sm btn-primary'
        - else
          = link_to 'Approve', approve_course_path(course), method: :patch, class: 'btn btn-sm btn-primary'
